<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì „ê¸°ê³„ì‚°ê¸° Pro - ì „ì••ê°•í•˜ í†µí•©ë³¸</title>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css" />
    <style>
        :root {
            --primary: #3b82f6; --primary-glow: rgba(59, 130, 246, 0.4);
            --accent: #60a5fa; --bg-dark: #020617;
            --card-bg: rgba(15, 23, 42, 0.8); --input-bg: #1e293b;
            --border: #334155; --text-main: #f8fafc; --text-muted: #94a3b8;
        }

        body {
            font-family: 'Pretendard', sans-serif; background-color: var(--bg-dark);
            background-image: radial-gradient(circle at top right, #1e1b4b, transparent);
            color: var(--text-main); margin: 0; padding: 20px 10px; display: flex; justify-content: center;
        }

        .container {
            width: 100%; max-width: 420px; background: var(--card-bg);
            backdrop-filter: blur(12px); border: 1px solid var(--border);
            border-radius: 24px; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); overflow: hidden;
        }

        .header { padding: 24px 20px; text-align: center; border-bottom: 1px solid var(--border); }
        .header h2 { 
            margin: 0; font-size: 1.25rem; font-weight: 800;
            background: linear-gradient(to right, #60a5fa, #a855f7);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        .content { padding: 20px; }
        .section-card { background: rgba(30, 41, 59, 0.5); border: 1px solid var(--border); border-radius: 16px; padding: 16px; margin-bottom: 20px; }
        
        label { display: block; font-size: 0.75rem; font-weight: 700; margin-bottom: 8px; color: var(--accent); text-transform: uppercase; }
        select, input { 
            width: 100%; padding: 12px; background: var(--input-bg); 
            border: 1px solid var(--border); border-radius: 10px; color: white; font-size: 0.95rem; box-sizing: border-box;
        }

        /* ì´ë¯¸ì§€ ì˜ì—­ */
        .visual-box { margin: 10px -16px -16px -16px; border-top: 1px solid var(--border); display: none; }
        .visual-box.active { display: block; }
        .img-wrap { height: 160px; display: flex; align-items: center; justify-content: center; cursor: zoom-in; position: relative; background: #000; }
        .method-img { width: 100%; height: 100%; object-fit: contain; }

        .btn-calc { 
            width: 100%; padding: 18px; background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white; border: none; border-radius: 14px; font-size: 1rem; font-weight: 800; cursor: pointer;
            box-shadow: 0 10px 20px -10px var(--primary-glow); transition: 0.3s;
        }
        .btn-calc:hover { transform: translateY(-2px); }

        /* ê²°ê³¼ ëŒ€ì‹œë³´ë“œ */
        .result-dashboard { 
            margin-top: 24px; padding: 20px; border-radius: 20px; border: 1px solid var(--primary); 
            background: linear-gradient(145deg, #1e293b, #0f172a); display: none;
        }
        .stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 15px; }
        .stat-item { padding: 12px; background: rgba(255,255,255,0.03); border-radius: 12px; text-align: center; }
        .stat-label { font-size: 0.7rem; color: var(--text-muted); display: block; margin-bottom: 4px; }
        .stat-value { font-size: 1.1rem; font-weight: 700; }
        .hero-sq { font-size: 2.8rem; font-weight: 900; color: #f87171; text-align: center; margin: 10px 0; text-shadow: 0 0 15px rgba(248,113,113,0.3); }

        #modal { display: none; position: fixed; z-index: 2000; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.98); justify-content: center; align-items: center; }
        #modal img { max-width: 100%; max-height: 90%; object-fit: contain; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h2>PREMIUM ELECTRIC PRO</h2>
        <p>KEC í—ˆìš©ì „ë¥˜ & ì „ì••ê°•í•˜ í†µí•© ì„ ì •</p>
    </div>
    
    <div class="content">
        <div class="section-card">
            <label>ğŸ“ ê³µì‚¬ ë°©ë²•</label>
            <select id="method" onchange="updateView()">
                <option value="B1" selected>B1 (ë§¤ì… ë°°ê´€)</option>
                <option value="A1">A1 (ì²œì¥ë‚´ ì€í)</option>
                <option value="C">C (íŠ¸ë ˆì´ / ë…¸ì¶œ)</option>
                <option value="E">E (ê³µì¤‘ í¬ì„¤)</option>
            </select>
            <div id="group-B1" class="visual-box active">
                <div class="img-wrap" onclick="openModal('b1_1.png')"><img src="b1_1.png" class="method-img"></div>
                <div class="img-wrap" onclick="openModal('b1_2.png')"><img src="b1_2.png" class="method-img"></div>
            </div>
            </div>

        <div class="section-card">
            <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                <div style="flex: 1;">
                    <label>ğŸŒ¡ï¸ ì£¼ìœ„ ì˜¨ë„</label>
                    <select id="temp">
                        <option value="1.00">30â„ƒ</option>
                        <option value="0.91" selected>40â„ƒ</option>
                        <option value="0.82">50â„ƒ</option>
                    </select>
                </div>
                <div style="flex: 1;">
                    <label>ğŸ“ ì„ ë¡œ ê¸¸ì´ (m)</label>
                    <input type="number" id="length" value="50">
                </div>
            </div>
            <div style="display: flex; gap: 10px;">
                <div style="flex: 1;">
                    <label>ğŸ“‰ í—ˆìš© ì „ì••ê°•í•˜ (%)</label>
                    <input type="number" id="vdrop_limit" value="4" step="0.1">
                </div>
                <div style="flex: 1;">
                    <label>âš¡ ì „ì•• ë°©ì‹</label>
                    <select id="voltage">
                        <option value="380">3ìƒ 380V</option>
                        <option value="220">ë‹¨ìƒ 220V</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="section-card">
            <div style="display: flex; gap: 10px;">
                <div style="flex: 1.5;">
                    <label>ë¶€í•˜ ìš©ëŸ‰ (kW)</label>
                    <input type="number" id="power" value="30">
                </div>
                <div style="flex: 1;">
                    <label>ì—­ë¥  (cosÏ†)</label>
                    <input type="number" id="pf" value="0.85" step="0.01">
                </div>
            </div>
        </div>

        <button class="btn-calc" onclick="calculate()">í†µí•© ê·œê²© ì‚°ì¶œ</button>

        <div id="result" class="result-dashboard">
            <div class="stat-grid">
                <div class="stat-item">
                    <span class="stat-label">ì„¤ê³„ì „ë¥˜ (Ib)</span>
                    <span class="stat-value" id="resIb">0.0 A</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">ì „ì••ê°•í•˜ìœ¨</span>
                    <span class="stat-value" id="resDrop" style="color:#facc15;">0.0 %</span>
                </div>
            </div>
            <div style="text-align: center; border-top: 1px solid var(--border); padding-top: 15px;">
                <span id="resMsg" style="font-size: 0.7rem; color: var(--accent); font-weight: bold;">ìµœì¢… ì„ ì • ê·œê²©</span>
                <div class="hero-sq" id="resSq">-- SQ</div>
                <p style="margin:0; font-size:0.7rem; color:var(--text-muted);">ì°¨ë‹¨ê¸° <span id="resIn">0</span>A | í—ˆìš©ì „ë¥˜ ë§Œì¡± ì—¬ë¶€ í™•ì¸ë¨</p>
            </div>
        </div>
    </div>
</div>

<div id="modal" onclick="closeModal()"><img id="modal-img" src=""></div>

<script>
function updateView() {
    const val = document.getElementById('method').value;
    document.querySelectorAll('.visual-box').forEach(el => el.classList.remove('active'));
    document.getElementById('group-' + val).classList.add('active');
}
function openModal(src) { document.getElementById('modal-img').src = src; document.getElementById('modal').style.display = 'flex'; }
function closeModal() { document.getElementById('modal').style.display = 'none'; }

const cableData = {
    "A1": { 2.5: 21, 4: 28, 6: 36, 10: 49, 16: 66, 25: 86, 35: 103, 50: 125, 70: 151, 95: 182, 120: 210 },
    "B1": { 2.5: 26, 4: 35, 6: 45, 10: 61, 16: 82, 25: 108, 35: 135, 50: 168, 70: 207, 95: 250, 120: 290 },
    "C":  { 2.5: 31, 4: 41, 6: 53, 10: 74, 16: 99, 25: 131, 35: 162, 50: 197, 70: 246, 95: 298, 120: 346 },
    "E":  { 2.5: 33, 4: 43, 6: 56, 10: 77, 16: 104, 25: 138, 35: 171, 50: 209, 70: 262, 95: 318, 120: 370 }
};
const mccb = [15, 20, 30, 40, 50, 60, 75, 100, 125, 150, 175, 200, 225, 250, 400];

function calculate() {
    const method = document.getElementById('method').value;
    const P = parseFloat(document.getElementById('power').value);
    const V = parseInt(document.getElementById('voltage').value);
    const pf = parseFloat(document.getElementById('pf').value);
    const kt = parseFloat(document.getElementById('temp').value);
    const L = parseFloat(document.getElementById('length').value);
    const dropLimit = parseFloat(document.getElementById('vdrop_limit').value);
    
    // 1. Ib ê³„ì‚°
    let ib = (V === 380) ? (P * 1000) / (Math.sqrt(3) * V * pf) : (P * 1000) / (V * pf);
    let in_rating = mccb.find(r => r >= ib) || "ë³„ë„ì‚°ì •";
    
    // 2. ì¼€ì´ë¸” ë¡œì§ (í—ˆìš©ì „ë¥˜ & ì „ì••ê°•í•˜ ë™ì‹œ ë§Œì¡± ì°¾ê¸°)
    let selectedSq = null;
    let finalDrop = 0;
    const currentTable = cableData[method];
    
    for (const [sq, amp] of Object.entries(currentTable)) {
        let iz = amp * kt;
        // ì¡°ê±´ A: í—ˆìš©ì „ë¥˜ ë§Œì¡± (In <= Iz)
        if (iz >= in_rating) {
            // ì¡°ê±´ B: ì „ì••ê°•í•˜ ë§Œì¡± ì²´í¬
            let factor = (V === 380) ? 17.8 : 35.6;
            let voltageDropV = (factor * L * ib) / (1000 * parseFloat(sq));
            let dropPercent = (voltageDropV / V) * 100;
            
            if (dropPercent <= dropLimit) {
                selectedSq = sq + " SQ";
                finalDrop = dropPercent;
                break;
            }
        }
    }

    if (!selectedSq) selectedSq = "ê·œê²© ì´ˆê³¼";

    document.getElementById('resIb').innerText = ib.toFixed(1) + " A";
    document.getElementById('resIn').innerText = in_rating;
    document.getElementById('resDrop').innerText = finalDrop.toFixed(2) + " %";
    document.getElementById('resSq').innerText = selectedSq;
    document.getElementById('result').style.display = 'block';
}
</script>
</body>
</html>
